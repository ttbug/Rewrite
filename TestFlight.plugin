#!name = 自动加入TF测试
#!desc = 定时申请TF，一旦有新的名额即刻自动加入，使用前请仔细看链接中使用说明！
#!author = DecoAri
#!homepage = https://github.com/DecoAri/JavaScript/blob/main/Surge/TF_keys.js
#!icon = https://raw.githubusercontent.com/Orz-3/mini/master/Color/testflight.png
#!input = APP_ID

# Boxjs订阅链接：https://raw.githubusercontent.com/githubdulong/Script/master/boxjs.json

# 使用方法步骤：
# 1: 导入插件
# 2: 到Mitm页面启用 Mitm over Http2
# 3: 启动VPN，进入到TestFlight App，显示通知信息获取成功
# 4: 到配置-> 持久化数据 -> 导入指定数据  key填写APP_ID，value填写你要加入的TF的ID，（ID为链接 https://testflight.apple.com/join/LPQmtkUs 的join后的字符串（也就是此例子的“LPQmtkUs”）⚠️：支持无限个TF链接，每个链接需要用英文逗号“,”隔开（如： LPQmtkUs,Hgun65jg,8yhJgv）

# 温馨提示：
# 1: 除beta已满的其他情况才会通知，可自行看日志
# 2: 报错1012是因为未执行使用方法的步骤2
# 3: 已支持同时挤🚪，支持无限TF链接
# 4: 获取tf信息的脚本与TestFlight账户管理模块冲突，使用的时候先关一下该模块

[Rule]
DOMAIN, testflight.apple.com, PROXY

[Script]
# 自动加入TF(每1小时执行一次)
cron "0 0-23/1 * * ?" script-path=https://raw.githubusercontent.com/chxm1023/Task/main/TestFlight/Auto_join_TF.js, timeout=150, enabled=false, tag=自动加入TF, img-url=https://raw.githubusercontent.com/Orz-3/mini/master/Color/testflight.png
# 获取TF信息(打开TF自动获取信息)
http-request ^https?:\/\/testflight\.apple\.com\/v3\/accounts\/.*\/apps$ script-path=https://raw.githubusercontent.com/chxm1023/Task/main/TestFlight/TF_keys.js, timeout=10, tag=TF信息获取, img-url=https://raw.githubusercontent.com/Orz-3/mini/master/Color/testflight.png
# APP_ID获取(打开TF链接获取APP_ID)
http-request ^https?:\/\/testflight\.apple\.com\/join\/(.*) script-path=https://raw.githubusercontent.com/chxm1023/Task/main/TestFlight/TF_keys.js, timeout=10, tag=APP_ID获取, img-url=https://raw.githubusercontent.com/Orz-3/mini/master/Color/testflight.png

[MITM]
hostname = testflight.apple.com
